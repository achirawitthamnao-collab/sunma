<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡∏á‡πà‡∏≤‡∏¢‡πÜ</title>
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <h2>üí¨ ‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô</h2>

    <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
    <div id="chatBox">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...</div>

    <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
    <div>
        <input type="text" id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠..." />
        <input type="text" id="message" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." />
        <button onclick="sendMessage()">‡∏™‡πà‡∏á</button>
    </div>

    <script>
        const BIN_ID = "68fa594fd0ea881f40b609a6";
        const API_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        async function loadMessages() {
            const box = document.getElementById("chatBox");
            box.innerHTML = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...";
            try {
                const res = await fetch(API_URL + "/latest");
                const data = await res.json();
                box.innerHTML = "";
                (data.record || []).forEach(c => {
                    const p = document.createElement("div");
                    p.className = "comment";
                    p.innerHTML = `<strong>${c.name}</strong>: ${c.text}`;
                    box.appendChild(p);
                });
            } catch (e) {
                box.innerHTML = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ";
            }
        }

        // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
        async function sendMessage() {
            const name = document.getElementById("name").value.trim();
            const text = document.getElementById("message").value.trim();
            if (!name || !text) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞!");

            try {
                const res = await fetch(API_URL + "/latest");
                const data = await res.json();
                const comments = data.record || [];
                comments.push({
                    name,
                    text
                });

                await fetch(API_URL, {
                    method: "PUT",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(comments)
                });

                document.getElementById("message").value = "";
                loadMessages();
            } catch (e) {
                alert("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à üò¢");
            }
        }

        loadMessages();
    </script>

</body>

</html>